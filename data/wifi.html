<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ESP32 Wi-Fi Setup</title>
<style>
  body { background:#0f172a; color:#e2e8f0; font-family:Arial, sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
  .card { background:#111827; padding:24px; border-radius:12px; width: min(520px, 92vw); box-shadow: 0 10px 30px rgba(0,0,0,.35);}
  h2 { margin:0 0 12px 0; }
  p  { margin:0 0 16px 0; color:#93c5fd }
  label { display:block; margin:12px 0 6px; }
  input, button { width:100%; padding:10px 12px; border-radius:8px; border:none; }
  input { background:#0b1220; color:#e2e8f0; outline:1px solid #1f2937; }
  input:focus { outline:2px solid #2563eb; }
  button { background:#2563eb; color:#fff; margin-top:14px; cursor:pointer; }
  .msg { margin-top:12px; min-height:20px; color:#a7f3d0 }
  small { color:#9ca3af }
</style>
</head>
<body>
<div class="card">
  <h2>Wi-Fi Setup</h2>
  <p>Connect this device to your network.</p>
  <label>SSID</label>
  <input id="ssid" placeholder="Your Wi-Fi name" autofocus>
  <label>Password <small>(optional)</small></label>
  <input id="pass" type="password" placeholder="Your Wi-Fi password">
  <button id="save">Save & Reboot</button>
  <div class="msg" id="msg"></div>
  <small>After reboot, reconnect to your router and open the device IP.</small>
</div>

<script>
document.getElementById('save').onclick = async () => {
  const ssid = document.getElementById('ssid').value.trim();
  const pass = document.getElementById('pass').value;
  const msg = document.getElementById('msg');
  if (!ssid) { msg.textContent = 'SSID is required.'; return; }
  try {
    const body = new URLSearchParams({ssid, pass}).toString();
    const r = await fetch('/save', { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body });
    const t = await r.text();
    msg.textContent = t || 'Saved.';
    setTimeout(()=> location.reload(), 1500);
  } catch(e) {
    msg.textContent = 'Error saving credentials.';
  }
};
</script>
</body>
</html>
